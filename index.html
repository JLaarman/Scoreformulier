<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dagelijkse Score Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }
    h1 {
      text-align: center;
      background: #2c3e50;
      color: white;
      padding: 15px 0;
      margin: 0 0 20px 0;
    }
    form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      gap: 15px;
      max-width: 600px;
      margin: 0 auto;
      padding: 0 10px;
    }
    .field {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
    }
    label {
      font-weight: bold;
      margin-bottom: 8px;
    }
    input[type="number"] {
      padding: 8px;
      font-size: 1rem;
    }
    button {
      margin: 20px auto;
      display: block;
      padding: 10px 20px;
      background: #2c3e50;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover {
      background: #1a242f;
    }
    canvas {
      max-width: 1000px;
      margin: 30px auto;
      display: block;
    }
  </style>
</head>
<body>

  <h1>Dagelijkse Score Tracker</h1>

  <form id="scoreForm">
    <div class="field">
      <label for="slaapkwaliteit">Slaapkwaliteit (0–10)</label>
      <input type="number" id="slaapkwaliteit" name="slaapkwaliteit" min="0" max="10" required>
    </div>
    <div class="field">
      <label for="ochtendstijfheid">Ochtendstijfheid (0–10)</label>
      <input type="number" id="ochtendstijfheid" name="ochtendstijfheid" min="0" max="10" required>
    </div>
    <div class="field">
      <label for="pijnscore">Pijnscore voeten (0–10)</label>
      <input type="number" id="pijnscore" name="pijnscore" min="0" max="10" required>
    </div>
    <div class="field">
      <label for="kilometers">Kilometers gelopen vandaag</label>
      <input type="number" id="kilometers" name="kilometers" min="0" step="0.1" required>
    </div>
  </form>

  <button type="button" id="saveBtn">Opslaan</button>

  <canvas id="trendChart"></canvas>

  <script>
    const slaapInput = document.getElementById('slaapkwaliteit');
    const stijfheidInput = document.getElementById('ochtendstijfheid');
    const pijnInput = document.getElementById('pijnscore');
    const kmInput = document.getElementById('kilometers');
    const saveBtn = document.getElementById('saveBtn');
    const chartCanvas = document.getElementById('trendChart');

    // Data ophalen uit localStorage
    let scores = JSON.parse(localStorage.getItem('scores')) || [];

    saveBtn.addEventListener('click', () => {
      const datum = new Date().toISOString().split('T')[0];

      const nieuweScore = {
        datum,
        slaap: Number(slaapInput.value),
        stijfheid: Number(stijfheidInput.value),
        pijn: Number(pijnInput.value),
        km: Number(kmInput.value),
      };

      // check of er al een entry is voor vandaag → overschrijven
      const bestaandeIndex = scores.findIndex(s => s.datum === datum);
      if (bestaandeIndex >= 0) {
        scores[bestaandeIndex] = nieuweScore;
      } else {
        scores.push(nieuweScore);
      }

      localStorage.setItem('scores', JSON.stringify(scores));
      updateChart();
      slaapInput.value = '';
      stijfheidInput.value = '';
      pijnInput.value = '';
      kmInput.value = '';
    });

    const ctx = chartCanvas.getContext('2d');
    let chart;

    function updateChart() {
      const labels = scores.map(s => s.datum);
      const slaapData = scores.map(s => s.slaap);
      const stijfheidData = scores.map(s => s.stijfheid);
      const pijnData = scores.map(s => s.pijn);
      const kmData = scores.map(s => s.km);

      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'Slaapkwaliteit',
              data: slaapData,
              borderColor: '#2980b9',
              fill: false,
              tension: 0.2,
            },
            {
              label: 'Ochtendstijfheid',
              data: stijfheidData,
              borderColor: '#e67e22',
              fill: false,
              tension: 0.2,
            },
            {
              label: 'Pijnscore voeten',
              data: pijnData,
              borderColor: '#c0392b',
              fill: false,
              tension: 0.2,
            },
            {
              label: 'Kilometers',
              data: kmData,
              borderColor: '#27ae60',
              fill: false,
              tension: 0.2,
              yAxisID: 'km',
            },
          ],
        },
        options: {
          responsive: true,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          plugins: {
            legend: {
              display: true,
              onClick: (e, legendItem, legend) => {
                const index = legendItem.datasetIndex;
                const ci = legend.chart;
                const meta = ci.getDatasetMeta(index);
                meta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;
                ci.update();
              }
            },
            title: {
              display: true,
              text: 'Trendoverzicht'
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 10,
              title: { display: true, text: 'Scores (0–10)' }
            },
            km: {
              beginAtZero: true,
              position: 'right',
              title: { display: true, text: 'Kilometers' }
            }
          }
        }
      });
    }

    updateChart();
  </script>

</body>
</html>
